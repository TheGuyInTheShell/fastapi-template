<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <img id="frame"></img>
    <script type="module">
        import { io } from "https://cdn.socket.io/4.7.5/socket.io.esm.min.js";

        try {
            const socket = io("http://localhost:8000/live", {
                path: "/sio/",
                auth: {
                    "key": "val"
                }
            });

            socket.on("connect", () => {
                console.log("Connected to Socket.IO server!");
                console.log("Socket ID:", socket.id);
            });

            socket.on("connect_info", (data) => {
                console.log("Connect info received:", data);
            });


            socket.on("sv:live:0", (msg) => {
                let array = new Uint8ClampedArray(msg);
                let url = URL.createObjectURL(new Blob([msg], { type: 'image/jpg' }));

                let img = document.querySelector('#frame');
                img.src = url;
            })

            socket.on("test2", (msg) => console.log("Test2 event:", msg))

        } catch (error) {
            console.log(error);
        }


    </script>
</body>

</html>